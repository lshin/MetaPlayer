/*
Metaplayer - A standards-based, multiple player, UI and Event framework for JavaScript.

Copyright (c) 2011 RAMP Holdings, Inc.

Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
*/
(function(){var d=window.jQuery,g=window.Popcorn,f={debug:"",layout:{},metadata:{},search:{},cues:{}},a=function(b,c){if(!(this instanceof a))return new a(b,c);this.config=d.extend({},f,c);a.dispatcher(this);this._plugins={};this._loadQueue=[];this.target=b;if(this.config.metadata)this.metadata=new a.MetaData(this,this.config);if(this.config.search)this.search=new a.Search(this,this.config);if(this.config.cues)this.cues=new a.Cues(this,this.config);if(b)if("string"==typeof b&&(b=d(b).get(0)),b.getTrackEvents instanceof
Function)this.video=b.media,this.popcorn=b;else if(b.play instanceof Function)this.video=b;if(b&&this.config.layout)this.layout=a.layout(b);var h=this;setTimeout(function(){h._load()},0)};a.READY="ready";a.DESTROY="destroy";a.prototype={load:function(){this._load();return this},destroy:function(){this.dispatcher.dispatch(a.DESTROY);delete this.plugins;delete this._loadQueue;delete this.layout;delete this.popcorn},log:function(b,a){if(!(0>this.config.debug.indexOf(a))){var h=Array.prototype.slice.apply(b);
h.unshift(a.toUpperCase());console.log.apply(console,h)}},_load:function(){if(this._loadQueue){!this.video&&this.layout&&this.html5();if(this.video&&!this.playlist)this.playlist=new a.Playlist(this,this.config);if(this.video&&!this.popcorn&&null!=g)this.popcorn=g(this.video);var b=this;d(this._loadQueue).each(function(a,h){h.fn.apply(b,h.args)});this._loadQueue=null;this.dispatcher.dispatch(a.READY);this.ready=!0}}};a.addPlugin=function(b,c){var h=a.prototype;if(h[b])throw"keyword unavailable: "+
b;h[b]=function(){this.ready?c.apply(this,arguments):this._loadQueue.push({name:b,args:arguments,fn:c});return this}};a.addPlayer=function(b,c){var h=a.prototype;if(h[b])throw"keyword unavailable: "+b;h[b]=function(){c.apply(this,arguments);return this}};window.MetaPlayer=a;window.Ramp=a;window.MPF=a})();
(function(){var d=jQuery,g={},f=function(a,b){this.config=d.extend({},g,b);MetaPlayer.dispatcher(this);this._cues={};this._rules={subtitle:{clone:"captions"}};this.player=a;this._addListeners()};MetaPlayer.Cues=f;f.CUES="cues";f.prototype={setCueLists:function(a,b){var c=this;d.each(a,function(a,d){c.setCues(a,d,b)})},getCueLists:function(a){return this._cues[a||this.player.metadata.getFocusUri()]},setCues:function(a,b,c){c=c||this.player.metadata.getFocusUri();this._cues[c]||(this._cues[c]={});this._cues[c][a]=
b;this._dispatchCues(c,a)},getCaptions:function(a){return this.getCues("captions",a)},getCues:function(a,b){var c=b||this.player.metadata.getFocusUri();if(!a)return this.getCueLists();if(this._rules[a]&&this._rules[a].clone)a=this._rules[a].clone;return!this._cues[c]||!this._cues[c][a]?[]:this._cues[c][a]},enable:function(a,b,c){c=d.extend({},this._rules[a],c);c.overrides=d.extend({},c.overrides,b);c.enabled=!0;this._rules[a]=c;this._renderCues(a,this.getCues(c.clone||a))},disable:function(a){if(a){if(this._rules[a])this._rules[a].enabled=
!1;this._removeEvents(a)}},destroy:function(){this._removeEvents();this.dispatcher.destroy();delete this.player},_dispatchCues:function(a,b){if(a==this.player.metadata.getFocusUri()){var c=this,h=[];b?h.push(b):this._cues[a]&&(h=d.map(this._cues[a],function(b,a){return a}));d.each(h,function(b,h){var d=c.getCues(h),g=c.createEvent();g.initEvent(f.CUES,!1,!0);g.uri=a;g.plugin=h;g.cues=d;c.dispatchEvent(g)&&c._renderCues(h,d)})}},_addListeners:function(){var a=this.player,b=a.metadata;a.listen(MetaPlayer.DESTROY,
this.destroy,this);b.listen(MetaPlayer.MetaData.FOCUS,this._onFocus,this)},_onFocus:function(a){this._removeEvents();this._dispatchCues(a.uri)},_removeEvents:function(a){var b=this.player.popcorn;if(b){var c=b.getTrackEvents();d.each(c,function(c,d){(!a||a==d._natives.type)&&b.removeTrackEvent(d._id)})}},_renderCues:function(a,b){var c=this;this._scheduleCues(a,b);d.each(this._rules,function(h,d){d.clone==a&&c._scheduleCues(h,b)})},_scheduleCues:function(a,b){var c=this._rules[a]||{},h;if(c.enabled){var f=
d.extend(!0,[],b);c.sequence&&d.each(f,function(b,a){if(h)h.end=a.start;h=a});c.duration&&d.each(f,function(b,a){a.end=a.start+c.duration});c.overrides&&d.each(f,function(b,a){d.extend(!0,a,c.overrides)});var g=this.player.popcorn;g&&g[a]instanceof Function&&d.each(f,function(b,c){g[a].call(g,d.extend({},c))})}}}})();
(function(){var d=jQuery,g={cssPrefix:"mp"};MetaPlayer.layout=function(f,a){this.config=d.extend(!0,{},g,a);this._iOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);var b=d(f._proxyNode||f),c=b.get(0),h,k=b.find(".mp-stage"),i=b.find("video");h=f.play instanceof Function;c="IFRAME"==c.tagName.toUpperCase();h||c?(h=d("<div></div>").addClass("metaplayer").insertAfter(b),h.width(b.width()),h.height(b.height())):h=b;h.addClass("metaplayer");0==k.length&&(k=d("<div></div>").addClass("mp-stage"),k.appendTo(h));
0<i.length&&k.append(i);h!==b&&k.append(b);return{target:f,base:h.get(0),stage:k.get(0)}}})();
(function(){var d=jQuery,g={},f=function(a,b){if(!(this instanceof f))return new f(b);this.config=d.extend({},g,b);MetaPlayer.dispatcher(this);this._data={};this._callbacks={};this._lastUri=null};MetaPlayer.MetaData=f;f.FOCUS="focus";f.LOAD="load";f.DATA="data";f.prototype={load:function(a,b,c){b?this._queue(a,b,c):this.setFocusUri(a);if(this._data[a]){if(this._data[a]._cached)return this._response(a),!0;if(this._data[a]._loading)return!0}this._data[a]||(this._data[a]={});this._data[a]._loading=(new Date).getTime();
b=this.createEvent();b.initEvent(f.LOAD,!1,!0);b.uri=a;b.data=this.getData(a);b=!this.dispatchEvent(b);if(!b)this._data[a]._loading=!1;return b},getFocusUri:function(){return this._lastUri},setFocusUri:function(a){if(this._lastUri!=a)this._lastUri=a,e=this.createEvent(),e.initEvent(f.FOCUS,!1,!0),e.uri=a,this.dispatchEvent(e)},getData:function(a){return this._data[a||this._lastUri]},setData:function(a,b,c){b=b||this._lastUri;this._data[b]=d.extend(!0,{},this._data[b],a);this._data[b]._cached=null==
c||c?!0:!1;this._response(b)},destroy:function(){this.dispatcher.destroy();delete this.player;delete this._callbacks;delete this._data;delete this.config},_queue:function(a,b,c){this._callbacks[a]||(this._callbacks[a]=[]);this._callbacks[a].push({fn:b,scope:c})},_response:function(a){var b=this._data[a];if(this._lastUri==a){var c=this.createEvent();c.initEvent(f.DATA,!1,!0);c.uri=a;c.data=b;this.dispatchEvent(c)}this._callbacks[a]&&(d.each(this._callbacks[a]||[],function(a,c){c.fn.call(c.scope,b)}),
delete this._callbacks[a])}}})();
(function(){var d=jQuery,g={sourceTags:!0,selectSource:!0,linkAdvance:!1,autoAdvance:!0,autoBuffer:!0,related:!0,loop:!1},f=function(a,b){this.config=d.extend({},g,b);this.player=a;this._tracks=[];this._index=0;this.loop=this.config.loop;this.preload=this.config.autoBuffer;this.advance=this.config.autoAdvance;this.linkAdvance=this.config.linkAdvance;MetaPlayer.dispatcher(this);this._addListeners()};MetaPlayer.Playlist=f;f.prototype={index:function(a){a=this._resolveIndex(a);if(null!=a)this._index=
a,this._select(this.track());return this._index},queue:function(a){a instanceof Array||(a=[a]);var b=0==this._tracks.length,c=this;d(a).each(function(b,a){c._addTrack(a,!0)});this.dispatcher.dispatch("playlistchange");b&&this._select(this.track())},_select:function(a){this.dispatcher.dispatch("trackchange");this.player.video.pause();this.player.metadata.load(a)||this._setSrc(a)},empty:function(){this.player.video.pause();this.player.video.src="";this._tracks=[];this.transcodes=null;this._index=0;
this.dispatcher.dispatch("playlistchange");this.dispatcher.dispatch("trackchange")},next:function(){var a=this._index+1,b=this.track(a);if(this.linkAdvance&&(b=b.link||b.linkURL)){window.top.location=b;return}this.index(a)},previous:function(){this.index(this._index-1)},track:function(a){void 0===a&&(a=this.index());return this._tracks[this._resolveIndex(a)]},nextTrack:function(){return this.track(this._index+1)},tracks:function(){return this._tracks},_addTrack:function(a,b){this._tracks.push(a);
b||this.dispatcher.dispatch("playlistchange")},_resolveIndex:function(a){if(null==a)return null;var b=this.tracks();0>a&&(a=b.length+a);this.loop&&(a%=b.length);return a>=b.length||0>a?null:a},_addListeners:function(){var a=this.player,b=this.player.metadata;a.listen(MetaPlayer.DESTROY,this.destroy,this);b.listen(MetaPlayer.MetaData.DATA,this._onMetaData,this);var c=this;d(a.video).bind("ended error",function(){c._onEnded()})},_onMetaData:function(a){if(a.uri==this.track())this.transcodes=a.data.content,
this.config.sourceTags&&this.addSourceTags(),this.config.selectSource&&this.selectSource()},addSourceTags:function(){var a=this,b=this.player.video;d.each(this.transcodes,function(c,d){b.appendChild(a._createSource(d.url,d.type))})},selectSource:function(){this.config.selectSource=!0;var a=this.player.video,b=[],c=[];if(this.transcodes){d.each(this.transcodes,function(d,h){var f=a.canPlayType(h.type);f&&("probably"==f?b.push(h.url):c.push(h.url))});var h=b.shift()||c.shift();h&&this._setSrc(h)}},
_setSrc:function(a){var b=this.player.video;b.src=a;b.autoplay||0<this.index()?b.play():b.preload&&b.load()},_createSource:function(a,b){return d("<source>").attr("type",b||"").attr("src",a)[0]},_onEnded:function(){this.advance&&(this.index()==this.tracks().length-1&&this.dispatcher.dispatch("playlistComplete"),this.next())},destroy:function(){this.dispatcher.destroy();delete this.player}}})();
(function(){var d=jQuery,g={forceRelative:!1},f=function(a,b){this.config=d.extend({},g,b);this.player=a;this.forceRelative=this.config.forceRelative;MetaPlayer.dispatcher(this);this.player.listen(MetaPlayer.DESTROY,this.destroy,this)};f.QUERY="QUERY";f.RESULTS="results";MetaPlayer.Search=f;MetaPlayer.addPlugin("search",function(){return new f(this)});f.prototype={query:function(a,b,c){var d=this.player.metadata.getData();if(!d.ramp.searchapi)throw"no searchapi available";var g=this.createEvent();
g.initEvent(f.QUERY,!1,!1);g.query=a;this.dispatchEvent(g);this._queryAPI(d.ramp.searchapi,a,b,c)},destroy:function(){this.dispatcher.destroy();delete this.player},_queryAPI:function(a,b,c,h){this.forceRelative&&(a=a.replace(/^(.*\/\/[\w.]+)/,""));var f={q:b};b?d.ajax(a,{dataType:"xml",timeout:15E3,context:this,data:f,error:function(b,c){console.error("Load search error: "+c+", url: "+a)},success:function(a){this.setResults(this.parseSearch(a,c,h),b,c,h)}}):this.setResults({query:[],results:[]},b,
c,h)},setResults:function(a,b,c,d){c?c.call(d,a,b):(c=this.createEvent(),c.initEvent(f.RESULTS,!1,!1),c.query=b,c.data=a,this.dispatchEvent(c))},parseSearch:function(a){var a=d(a),b=this,c={query:[],results:[]};a.find("SearchTerms Term").each(function(){c.query.push(b._deSmart(d(this).text()))});a.find("Snippets Snippet").each(function(a,f){var g=d(f),j={start:g.attr("time"),words:[]},g=g.find("T");d.each(g,function(a,c){var h=d(c);j.words.push({match:Boolean(h.find("MQ").length),start:h.attr("s"),
text:b._deSmart(h.text())})});c.results.push(j)});return c},_deSmart:function(a){return a.replace(/\xC2\x92/,"\u2019")}}})();
(function(){var d=function(g){if(g&&g.dispatcher instanceof d)return g.dispatcher;if(!(this instanceof d))return new d(g);this._listeners={};this.attach(g)};MetaPlayer.dispatcher=d;d.Event=function(){this.defaultPrevented=this.cancelBubble=!1};d.Event.prototype={initEvent:function(d,f,a){this.type=d;this.cancelable=a},stopPropagation:function(){this.cancelBubble=!0},stopImmediatePropagation:function(){this.cancelBubble=!0},preventDefault:function(){if(this.cancelable)this.defaultPrevented=!0}};d.prototype=
{attach:function(d){if(d)d.addEventListener?MetaPlayer.proxy.proxyFunction("addEventListener removeEventListener dispatchEvent",d,this):MetaPlayer.proxy.proxyFunction("addEventListener removeEventListener dispatchEvent",this,d),MetaPlayer.proxy.proxyFunction("listen forget dispatch createEvent",this,d),d.dispatcher=this},destroy:function(){delete this._listeners;delete this.addEventListener;delete this.removeEventListener;delete this.dispatchEvent;this.__destroyed=!0},listen:function(d,f,a){this.addEventListener(d,
function(b){f.call(a,b,b.data)})},forget:function(d,f){this.removeEventListener(d,f)},dispatch:function(d,f){var a=this.createEvent();a.initEvent(d,!0,!0);a.data=f;return this.dispatchEvent(a)},addEventListener:function(d,f){this._listeners[d]||(this._listeners[d]=[]);this._listeners[d].push(f)},removeEventListener:function(d,f){var a=this._listeners[d]||[],b;for(b=a.length-1;0<=b;b--)a[b]==f&&a.splice(b,1)},createEvent:function(g){return document.createEvent?document.createEvent(g||"Event"):new d.Event},
dispatchEvent:function(d){for(var f=this._listeners[d.type]||[],a=0;a<f.length&&!d.cancelBubble;a++)f[a].call(f[a].scope||this,d,d.data);return!d.defaultPrevented}}})();
(function(){MetaPlayer.format={seconds:function(d){var g=function(b,a){for(var d=""+b;d.length<a;)d="0"+d;return d},f=Math.floor(d/3600),a=Math.floor(d%60),d=[g(Math.floor(d%3600/60),2),g(a,2)];f&&d.unshift(f);return d.join(":")},replace:function(d,g){return d.replace(/\{\{(\w+)\}\}/g,function(d,a){var b;if(g[a]instanceof Function)b=g[a](g);else if(null!=g[a])b=g[a];else return"{!!!"+a+"!!!}";return MetaPlayer.format.replace(b.toString(),g)})}}})();
(function(){var d=jQuery,g={proxyProperty:function(f,a,b){d.each(f.split(/\s+/g),function(c,d){g.mapProperty(d,b,a)})},proxyFunction:function(f,a,b){d.each(f.split(/\s+/g),function(c,d){b[d]=function(){return a[d].apply(a,arguments)}})},proxyEvent:function(f,a,b){b.addEventListener||Ramp.dispatcher(b);d.each(f.split(/\s+/g),function(c,d){a.addEventListener(d,function(a){if(b.dispatch)b.dispatch(a.type);else{var c=document.createEvent("Event");c.initEvent(a.type,!1,!1);b.dispatchEvent(c)}})})},mapProperty:function(f,
a,b){b||(b=a);d.each(f.split(/\s+/g),function(c,d){var f=void 0==b[d]?"_"+d:d,i;i=b[f]instanceof Function?function(){return b[f].apply(b,arguments)}:function(a){void 0!==a&&(b[f]=a);return b[f]};g.define(a,d,{get:i,set:i})})},define:function(d,a,b){try{return Object.defineProperty(d,a,b)}catch(c){}d.__defineGetter&&b.get&&d.__defineGetter__(a,b.get);b.set&&d.__defineSetter__&&d.__defineSetter__(a,b.set)},getProxyObject:function(d){d||(d=document.createElement("div"));try{return Object.defineProperty(d,
"__proptest",{}),d}catch(a){}var b={_proxyNode:d,parentNode:d.parentNode,tagName:d.tagName,ownerDocument:d.ownerDocument,style:d.style,appendChild:function(){d.appendChild.apply(d,arguments)}};try{return Object.defineProperty(b,"__proptest",{}),b}catch(c){}throw"Object.defineProperty not defined";},proxyPlayer:function(d,a){var b=Ramp.proxy.getProxyObject(a);g.mapProperty("duration currentTime volume muted seeking paused controls autoplay preload src ended readyState",b,d);g.proxyFunction("load play pause canPlayType",
d,b);g.proxyPlayerEvents(d,b);return b},proxyPlayerEvents:function(d,a){g.proxyEvent("timeupdate seeking seeked playing play pause loadeddata loadedmetadata canplay loadstart durationchange volumechange ended error",d,a)}};if(!window.Ramp)window.Ramp={};MetaPlayer.proxy=g})();
(function(){var d=jQuery;Ramp.script={url:function(g){var f,a=RegExp(g);d("script").each(function(b,c){var h=d(c).attr("src");if(h&&h.match(a))return f=h,!1});return f},base:function(d){d||(d="metaplayer(-complete)?(.min)?.js");d=this.url(d)||"";return d.substr(0,d.lastIndexOf("/")+1)}}})();
(function(){var d=jQuery,g={fixedHeight:!1,minHeight:20,mouseDrag:!1,inertial:!1},f=function(b,a){this.config=d.extend(!0,{},g,a);this.init(b);this.inertiaY=0},a=function(b){return b.pageX||b.originalEvent.touches[0].pageX},b=function(b){return b.pageY||b.originalEvent.touches[0].pageY};f.prototype={init:function(b){this.parent=d(b);var a=this,f=this.parent[0].childNodes;this.body=d("<div></div>").addClass("mp-scroll-body").css("position","relative").bind("resize DOMSubtreeModified size change",function(b){a.onResize(b)}).append(f);
this.scroller=d("<div></div>").css("width","100%").css("height","100%").css("overflow","hidden").addClass("mp-scroll").append(this.body).appendTo(b);this._touchStop=function(b){a.onTouchStop(b)};this._touchMove=function(b){a.onTouchMove(b)};this._knobStop=function(b){a.onKnobStop(b)};this._knobMove=function(b){a.onKnobMove(b)};this.knob=d("<div></div>").css("position","absolute").css("background","black").css("top",0).css("right","-10px").css("border-radius","4px").css("background","#000").css("opacity",
0.4).css("cursor","pointer").width(8).addClass("mp-scroll-knob").appendTo(this.parent).bind("mousedown touchstart",function(b){a.onKnobStart(b)});this.parent.css("position","relative").css("overflow","visible").bind("mousewheel",function(b){a.onScroll(b)}).bind((this.config.mouseDrag?"mousedown":"")+" touchstart",function(b){a.onTouchStart(b)});this.scrollTo(0,0)},onScroll:function(b){this.scrollBy(-(b.originalEvent.wheelDeltaX||b.originalEvent.delta||0),-(b.originalEvent.wheelDeltaY||b.originalEvent.delta||
0));b.preventDefault()},scrollBy:function(b,a,d){var f=this.scroller.scrollLeft(),g=this.scroller.scrollTop();this.scrollTo(f+b,g+a,d)},scrollTop:function(){return this.scroller.scrollTop()},scrollTo:function(b,a,d){var f=this.body.height()-this.parent.height(),g=0<f&&this.scroller.scrollTop()+1>=f;a>f&&(a=f);0>a&&(a=0);this.scroller.stop();if(d&&!g){var m=this;this._scrollY=a;this.scroller.animate({scrollLeft:b,scrollTop:a},d,function(){m._scrollY=null});this.render(d)}else this.scroller.scrollLeft(b),
this.scroller.scrollTop(a),this.render()},render:function(b){if(this.body){var a=this.body.height(),d=this.parent.height(),f=Math.min(d-(a-d)/a*d,d);if(f<this.config.minHeight||this.config.fixedHeight)f=this.config.minHeight;a=(null!=this._scrollY?this._scrollY:this.scroller.scrollTop())/(a-d);a*=d-f;this.knob.toggle(f<d);b?this.knob.stop().animate({height:f,top:a},b):this.knob.stop().height(f).css("top",a)}},onResize:function(){this.render(1E3)},onTouchStart:function(c){this.touching={lastX:this.scroller.scrollLeft(),
lastY:this.scroller.scrollTop()};this.touching.x=a(c)+this.touching.lastX;this.touching.y=b(c)+this.touching.lastY;d(document).bind("mousemove touchmove",this._touchMove).bind("mouseup touchend",this._touchStop);if(this.config.inertial){var f=this;this.inertiaInterval=setInterval(function(){f.onInertiaUpdate()},30)}},onInertiaUpdate:function(){this.inertiaY*=0.9;this.touching||(1>this.inertiaY&&clearInterval(this.inertiaInterval),this.scrollBy(0,this.inertiaY))},onTouchStop:function(){d(document).unbind("mousemove touchmove",
this._touchMove).unbind("mouseup touchend",this._touchStop);this.touching=null},onTouchMove:function(c){var d=-1*(a(c)-this.touching.x),f=-1*(b(c)-this.touching.y);this.inertiaY+=f-this.touching.lastY;this.touching.lastX=d;this.touching.lastY=f;this.scrollTo(d,f);c.stopPropagation();c.preventDefault()},onKnobStart:function(c){this.scroller.stop();this.dragging={x:a(c)-this.knob.position().left,y:b(c)-this.knob.position().top};d(document).bind("mousemove touchmove",this._knobMove).bind("mouseup touchend",
this._knobStop);c.stopPropagation();c.preventDefault()},onKnobStop:function(){d(document).unbind("mousemove touchmove",this._knobMove).unbind("mouseup touchend",this._knobStop);this.dragging=null},onKnobMove:function(c){var d=a(c)-this.dragging.x,c=b(c)-this.dragging.y,f=this.body.height(),g=this.parent.height(),j=this.knob.height();this.scrollTo(d,c/(g-j)*(f-g))}};if(!window.MetaPlayer)window.MetaPlayer={};MetaPlayer.scrollbar=function(b,a){return new f(b,a)}})();
(function(){var d=function(g,f){if(!(this instanceof d))return new d(g,f);var a=this;Ramp.dispatcher(this);this.delay=g;this.count=f||-1;this._counted=0;this._onTimeout=function(){a._counted++;a.dispatcher.dispatch("time",{count:a._counted,remain:a.count-a._counted});0<a.count&&a.count<a._counted+1&&(a.reset(),a.dispatcher.dispatch("complete"))}};Ramp.timer=d;d.prototype={reset:function(){this._counted=0;this.stop()},stop:function(){clearInterval(this._interval);this.running=this._interval=null},
toggle:function(){this.running?this.stop():this.start()},start:function(){if(!this._interval)this.running=(new Date).getTime(),this._interval=setInterval(this._onTimeout,this.delay)}}})();
(function(){var d=jQuery;if(!window.Ramp)window.Ramp={};Ramp.ui={ensureOffsetParent:function(g){var g=d(g).first(),f=g[0];if(!(f.offsetParent===f.parentNode&&f.offsetParent.offsetParent)){var a=d("<div></div>");a.css("position","relative");a.css("top",0);a.css("left",0);a.css("width","100%");a.css("height","100%");f.width&&a.width(f.width);f.height&&a.height(f.height);g.css("width","100%");g.css("height","100%");g.parent().append(a);a.append(g)}}}})();
(function(){var d=jQuery,g={},f=function(a,b){if(!(this instanceof f))return new f(a,b);this.config=d.extend({},g,b);this.dispatcher=MetaPlayer.dispatcher(a);this.dispatcher.attach(this);this.dispatcher.listen("trackchange",this._onTrackChange,this)};if(!window.Ramp)window.Ramp={};MetaPlayer.mrss=function(a){return f(null,a)};MetaPlayer.addPlugin("mrss",function(a){this.service=f(this.video,a)});f.prototype={load:function(a){d.ajax(a,{dataType:"xml",timeout:15E3,context:this,data:{},error:function(b,
c){console.error("Load playlist error: "+c+", url: "+a)},success:function(b){this.setData(this.parse(b))}})},setData:function(a){this._data=a;var b=this.dispatcher;b.dispatch("metadata",a.metadata);b.dispatch("transcodes",a.transcodes);b.dispatch("captions",a.captions);b.dispatch("tags",a.tags);b.dispatch("metaq",a.metaq);b.dispatch("related",a.related)},_onTrackChange:function(a,b){b&&(a.preventDefault(),"string"==typeof b?this.load(b):this.setData(b))},parse:function(a){var b=this,c=[],a=d(a).find("item").toArray();
d.each(a,function(a,d){c.push(b.parseItem(d))});a=c.shift();a.related=c;return a},parseItem:function(a){var b={metadata:{},transcodes:[],tags:[],captions:[],metaq:{},related:[]},a=d(a),c=a.find("media:content, content");d.each(c,function(a,c){var c=d(c),f=c.attr("codec"),g=c.attr("type")+(f?'codec="'+f+'"':"");b.transcodes.push({url:c.attr("url"),fileSize:c.attr("fileSize"),type:g,medium:c.attr("medium"),isDefault:c.attr("isDefault"),expression:c.attr("expression"),bitrate:c.attr("bitrate"),framerate:c.attr("framerate"),
samplingrate:c.attr("samplingrate"),channels:c.attr("channels"),duration:c.attr("duration"),height:c.attr("height"),width:c.attr("width"),lang:c.attr("lang"),codec:f})});b.metadata.title=a.find("media:title, title").text();b.metadata.description=a.find("media:description, description").text()||a.find("]").text();b.metadata.thumbnail=a.find("media:thumbnail, thumbnail").attr("url");return b},search:function(){throw"not implemented";}}})();
(function(){var d=jQuery,g={msQuotes:!0,serviceUri:"/device/services/mp2-playlist?e="},f=function(a){this.config=d.extend({},g);this.dispatcher=MetaPlayer.dispatcher(this);this.player=a;this._currentUrl=null;this.player.listen(MetaPlayer.READY,this.onReady,this)};MetaPlayer.addPlugin("ramp",function(a,b){if(!this._ramp)this._ramp=new f(this,a);var c=this._ramp;if(a)this.ready?c.load(a,!0):c._currentUrl=a;if(b)c.config=d.extend(c.config,b);return this});f.prototype={onReady:function(){this.player.metadata.listen(MetaPlayer.MetaData.LOAD,
this.onMetaDataLoad,this);this.player.metadata.listen(MetaPlayer.DESTROY,this.onDestroy,this);this._currentUrl&&this.load(this._currentUrl,!0)},onMetaDataLoad:function(a){var b=a.data;b.ramp&&b.ramp.serviceURL&&(this.load(b.ramp.serviceURL),a.stopPropagation(),a.preventDefault())},onDestroy:function(){this.dispatcher.destroy();delete this.config;delete this.player},load:function(a,b){var c=a;if("string"==typeof a&&a.match(/^ramp\:/))var f=this.parseUrl(a),c=f.rampHost+this.config.serviceUri+f.rampId;
d.ajax(c,{dataType:"xml",timeout:15E3,context:this,data:{},error:function(b,a,c){b=this.createEvent();b.initEvent(a,!1,!0);b.message=c;this.dispatchEvent(b)},success:function(a){a=this.parse(a,c);a.length&&this.setItems(a,b)}})},setItems:function(a,b){var c=this.player.metadata,f=this.player.playlist,g=this.player.cues,i=a[0],j=i.metadata.guid;b&&c.setFocusUri(j);c.setData(i.metadata,j,!0);g.setCueLists(i.cues,j);f&&b&&(d.each(a.slice(1),function(b,a){c.setData(a.metadata,a.metadata.guid,!1)}),f.empty(),
f.queue(d.map(a,function(b){return b.metadata.guid})))},parse:function(a,b){var c=this,f=d(a).find("par").toArray(),g=[];d.each(f,function(a,d){g.push(c.parseMedia(d,b))});return g},parseMedia:function(a,b){var c={metadata:{},cues:{}},f=this,g=d(a).find("video");c.metadata.title=g.attr("title");c.metadata.description=g.find("metadata meta[name=description]").text();c.metadata.thumbnail=g.find("metadata meta[name=thumbnail]").attr("content");c.metadata.guid=g.find("metadata meta[name=rampId]").attr("content");
c.metadata.link=g.find("metadata meta[name=linkURL]").attr("content");c.metadata.ramp={};g.find("metadata meta").each(function(b,a){var f=d(a);c.metadata.ramp[f.attr("name")]=f.attr("content")||f.text()});if(c.metadata.ramp.rampId&&!c.metadata.ramp.serviceURL&&b.match(/mp2[-\/]playlist/))c.metadata.ramp.serviceURL=b.replace(/e=(\d+)/,"e="+c.metadata.ramp.rampId);c.metadata.content=[];c.metadata.content.push({name:"default",url:g.attr("src"),type:f.resolveType(g.attr("src")),isDefault:!0});d(a).find("metadata[xml\\:id^=transcodes]").find("meta").each(function(b,
a){var g=d(a);c.metadata.content.push({name:g.attr("name"),type:g.attr("type")||f.resolveType(g.attr("content")),url:g.attr("content"),isDefault:!1})});c.metadata.ramp.tags=[];d(a).find("seq[xml\\:id^=jumptags]").find("ref").each(function(b,a){var f={};d(a).find("param").each(function(b,a){var c=d(a);f[c.attr("name")]=c.text()});if(f.timestamps)f.timestamps=f.timestamps.split(",");c.metadata.ramp.tags.push(f)});c.cues={};d(a).find("seq[xml\\:id^=metaqs]").find("ref").each(function(b,a){var g={};d(a).find("param").each(function(b,
a){var c=d(a),k=c.attr("name"),c=f.deSmart(c.text());"code"==k?(k=d.parseJSON(c),d.extend(!0,g,k)):g[k]=c});c.cues[g.plugin]||(c.cues[g.plugin]=[]);c.cues[g.plugin].push(g)});g=d(a).find("smilText");c.cues.captions=this.parseCaptions(g);return c},parseCaptions:function(a){var b=this,c=d(a).contents(),f=[],g={text:"",start:0,offset:0},i,j=function(a,c){var l;l=d(a);var j=l.attr("begin");null!=j?l=b.parseSeconds(j):(l=l.attr("next"),l=null!=l?b.parseSeconds(l)+(void 0).start:void 0);i=g;i.end=l;c&&
(i.text+=c);f.push(i);g={text:"",start:l,offset:g.offset+1}};c.each(function(a,d){var f=c[a].data;if(void 0===d.tagName)b.config.msQuotes&&(f=b.deSmart(f)),g.text+=f;else switch(d.tagName){case "smil:clear":case "clear":j(d);break;case "smil:tev":case "tev":j(d);break;case "smil:br":case "br":j(d,"<br />");break;default:throw"unsupported tag";}});g.text&&f.push(g);return f},parseSeconds:function(a){var b=a.substr(-1),c=parseFloat(a);if("s"==b)return c;if("m"==b)return 60*c;if("h"==b)return 3600*c;
b=0;a=a.split(":");for(c=0;c<Math.min(a.length,4);c++)b+=Math.pow(60,c)*parseFloat(a[c]);return b},parseUrl:function(a,b){var c=a.split(":");void 0==b&&(b={});"ramp"!==c[0]?b.url=a:(b.rampHost=c[1],b.rampId=c[2]);return b},toUrl:function(a){return"ramp:"+a.ramp.rampHost+":"+a.ramp.rampId},deSmart:function(a){return a.replace(/\xC2\x92/,"\u2019")},resolveType:function(a){var b=a.substr(a.lastIndexOf(".")+1);return a.match("www.youtube.com")?"video/youtube":"ogv"==b?"video/ogg":"m3u8"==b?"application/application.vnd.apple.mpegurl":
"video/"+b}}})();
(function(){var d=jQuery,g={applySources:!0,selectSource:!0,preload:!0,muted:!1,autoplay:!1,autoAdvance:!0,related:!0,loop:!1,volume:1,controls:!0},f=function(a,b){if(!(this instanceof f))return new f(a,b);this._iOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);this.config=d.extend({},g,b);this._createMarkup(a)};MetaPlayer.addPlayer("html5",function(a){this.video=(new f(this.layout.stage,a)).video});MetaPlayer.html5=function(a,b){return(new f(a,b)).video};f.prototype={_createMarkup:function(a){var b=d(a),
c=b.find("video");if(b.is("video")||null!=a.currentTime)c=b;0<c.length?this._iOS?(this.video=c.clone(!0,!0).appendTo(c.parent()).get(0),c.remove()):this.video=c.get(0):(a=document.createElement("video"),a.autoplay=this.config.autoplay,a.preload=this.config.preload,a.controls=this.config.controls,a.muted=this.config.muted,a.volume=this.config.volume,a.style.height="100%",a.style.width="100%",this.video=a,b.append(a))}}})();
(function(){var d=jQuery,g=window.flowplayer,f={autoplay:!1,preload:!0,controls:!0,swfUrl:"flowplayer-3.2.7.swf",wmode:"transparent",cssName:"mp-flowplayer",statusThrottleMSec:500,fpConfig:{clip:{scaling:"fit"},canvas:{backgroundColor:"#0000000",backgroundGradient:"none"}}},a=function(b,c){if(!(this instanceof a))return new a(b,c);this.config=d.extend(!0,{},f,c);this.dispatcher=MetaPlayer.dispatcher(this);this._iOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);this.__seeking=null;this.__readyState=
0;this.__ended=!1;this.__paused=!0;this.__duration=NaN;this._pageSetup(b);this.__preload=this.config.preload;this.__autoplay=this.config.autoplay;this.__src="";this._statepoll=Ramp.timer(250);this._statepoll.listen("time",this._onPlayStatePoll,this);this._timeupdater=Ramp.timer(250);this._timeupdater.listen("time",this._onTimeUpdate,this);var g=this;this._flowplayer.onLoad(function(){g._onLoad()});this.video=MetaPlayer.proxy.proxyPlayer(this,this._flowplayer.getParent())};MetaPlayer.flowplayer=function(b,
c){return a(b,c).video};MetaPlayer.addPlayer("flowplayer",function(b,c){b.getCommonClip||(c=b,b=d("<div></div>").addClass("mp-video").appendTo(this.layout.stage));this.flowplayer=a(b,c);this.video=this.flowplayer.video});a.prototype={_pageSetup:function(b){if(b.getCommonClip)this._flowplayer=b,b=this._flowplayer.getCommonClip(),this.preload(Boolean(b.autoBuffering)),this.autoplay(Boolean(b.autoPlay));else{var b=d(b).get(0),a=d.extend(!0,{clip:{autoPlay:!1,autoBuffering:!0}},this.config.fpConfig);
this._flowplayer=g(b,{src:this.config.swfUrl,wmode:this.config.wmode},a)}},_onLoad:function(){if(!this._onLoadFired){this._onLoadFired=!0;var b=this;this._flowplayer.onVolume(function(){b.dispatch("volumechange")});this._flowplayer.onMute(function(){b.dispatch("volumechange")});this._flowplayer.onUnmute(function(){b.dispatch("volumechange")});this._flowplayer.onPlaylistReplace(function(){b.dispatch("playlistChange")});this._flowplayer.onClipAdd(function(){b.dispatch("playlistChange")});this.controls(this.config.controls);
if(this.__src)this.src(this.__src);else{var a=fp.getClip(0);if(a)this._addClipListeners(a),this.__src=a.url}b.dispatch("loadstart");(this.preload()||this.autoplay())&&this.load()}},_addClipListeners:function(b){var a=this;b&&(b.onBeforeBegin(function(){return!0}),b.onBegin(function(){a._flowplayer.setVolume(100);a._flowplayer.unmute()}),b.onStart(function(b){a._setReady();a._setPlaying(!0);if(a._iOS&&!a.__controls)d(a._flowplayer.getParent()).find("video").get(0).controls=!1;a.dispatch("loadeddata");
a.__duration=b.duration;a.dispatch("durationchange");a.dispatch("loadedmetadata")}),b.onStop(function(){}),b.onFinish(function(){a.__ended=!0;a.__seeking=null;a._setPlaying(!1);a._flowplayer.stop();a.dispatch("ended")}),b.onPause(function(){a._setPlaying(!1);a._setReady()}),b.onResume(function(){a._setPlaying(!0);a.dispatch("play")}),b.onBeforeSeek(function(){a.dispatch("seeking");a.dispatch("timeupdate");if(a.paused())a.dispatch("seeked"),a.__seeking=null}),b.onSeek(function(){this.__currentTimeCache=
0;a.__seeking=null;a.paused()||a.dispatch("seeked")}))},_setReady:function(){4!=this.__readyState?(this.__readyState=4,this.dispatch("canplay")):(this.dispatch("seeking"),this.dispatch("seeked"))},_setPlaying:function(b){this.__paused=!b;this._statepoll.start()},load:function(){this.preload(!0);if(this.src()&&this._flowplayer.isLoaded())this._flowplayer.getClip(0).update({autoPlay:this.autoplay(),autoBuffer:!0}),window.flashembed.__replaced&&!this.__loaded?(this._flowplayer.play(0),this.autoplay()&&
this._flowplayer.play(0),this.__loaded=!0):this.autoplay()?this._flowplayer.play():this._flowplayer.startBuffering()},play:function(){this.autoplay(!0);this.__paused=!1;this.load()},pause:function(){this._flowplayer.pause()},canPlayType:function(b){var a=null;if(window.flashembed.__replaced){if(!this._video)this._video=document.createElement("video");this._iOS&&b.match(/mpegurl|m3u8/i)?a="probably":this._video.canPlayType&&(a=this._video.canPlayType(b))}else b.match(/mp4|flv|jpg$/)&&(a="probably");
return a},paused:function(){return this.__paused},duration:function(){return this.__duration},seeking:function(){return null!==this.__seeking},ended:function(){return this.__ended},currentTime:function(a){if(void 0!==a){0>a&&(a=0);if(a>this.duration)a=this.duration;this.__seeking=a;this._flowplayer.seek(a)}if(null!==this.__seeking)return this.__seeking;if(!this._flowplayer.isLoaded())return 0;var a=(new Date).getTime(),c=this.__currentTimeCache,d=a-c;if(c&&d<this.config.statusThrottleMSec)return this.__currentTime+
d/1E3;this.__currentTimeCache=a;return this.__currentTime=this._flowplayer.getStatus().time},muted:function(a){void 0!==a&&(a?this._flowplayer.mute():this._flowplayer.unmute());a=this._flowplayer.getStatus();return Boolean(a.muted)},volume:function(a){void 0!==a&&this._flowplayer.setVolume(100*a);return this._flowplayer.getVolume()/100},controls:function(a){if(!this._flowplayer.isLoaded()){if(void 0!==a)this.config.controls=a;return this.config.controls}var c=this._flowplayer.getControls(),f=this._flowplayer.getPlugin("play"),
g=d(this._flowplayer.getParent()).find("video").get(0);if(void 0!==a)(this.__controls=a)?(c&&c.show(),f&&f.show(),g&&(g.controls=!0)):(c&&c.hide(),f&&f.hide(),g&&(g.controls=!1));return this.__controls},preload:function(a){if(void 0!==a)this.__preload=a;return this.__preload},autoplay:function(a){if(void 0!==a)this.__autoplay=a;return this.__autoplay},loop:function(a){if(void 0!==a)this.__loop=a;return this.__loop},src:function(a){if(void 0!==a)this.__src=a,this.__loaded=!1,this.__duration=NaN,a=
this._flowplayer,a.isLoaded()&&(a.setClip({autoPlay:!1,autoBuffering:!1,url:this.__src}),this._addClipListeners(a.getClip(0)));return this.__src},readyState:function(a){if(void 0!==a)this.__readyState=a;return this.__readyState},_onPlayStatePoll:function(){this._flowplayer.isPlaying()!==this.paused()&&(this._statepoll.reset(),this.paused()?(this.dispatch("pause"),this._timeupdater.reset()):(this.autoplay(!0),this.dispatch("playing"),this.dispatch("play"),this._timeupdater.start()))},_onTimeUpdate:function(){this.dispatch("timeupdate")}}})();
(function(){var d=jQuery,g={autoplay:!1,preload:!0,updateMsec:500,playerVars:{enablejsapi:1,version:3,autohide:0,autoplay:0,controls:1,fs:1,hd:1,rel:1,showinfo:1,iv_load_policy:0,cc_load_policy:0,wmode:"transparent"}},f=function(a,b){this.config=d.extend(!0,{},g,b);this.__seeking=!1;this.__readyState=0;this.__muted=this.__ended=!1;this.__paused=!0;this.__duration=NaN;this.__currentTime=0;this.__volume=1;this.__loop=this.config.loop;this.__src="";if(this.config.chromeless){var c=this.config.playerVars;
c.controls=0;c.rel=0;c.showinfo=0}this.preload=this.config.preload;this.autoplay=this.config.autoplay;this.updateMsec=this.config.updateMsec;MetaPlayer.dispatcher(this);"string"==typeof a||!a.getVideoEmbedCode?(this.container=d(a).get(0),this.target=d("<div></div>").appendTo(this.container).get(0),this.init()):(this.youtube=a,this.container=d("<div></div>").appendTo(a.a.parentNode).append(a.a).get(0),this.addListeners());this.video=MetaPlayer.proxy.proxyPlayer(this,this.container)};MetaPlayer.addPlayer("youtube",
function(a,b){!b&&a instanceof Object&&!a.getVideoEmbedCode&&(b=a,a=null);b||(b={});if(!a){if(null==b.chromeless)b.chromeless=!0;a=d("<div></div>").addClass("mp-video").appendTo(this.layout.stage)}var c=new f(a,b);this.video=c.video;this.youtube=c});MetaPlayer.youtube=function(a,b){return(new f(a,b)).video};f.prototype={init:function(){if(window.YT instanceof Function)this.onApiReady();else{var a=document.createElement("script");a.src="http://www.youtube.com/player_api";var b=document.getElementsByTagName("script")[0];
b.parentNode.insertBefore(a,b);var c=this,d=window.onYouTubePlayerAPIReady;window.onYouTubePlayerAPIReady=function(){c.onApiReady();d&&d.call(window)}}},onApiReady:function(){this.youtube=new YT.Player(this.target,{height:"100%",width:"100%",playerVars:this.config.playerVars});this.addListeners()},addListeners:function(){var a=this.youtube,b=this;a.addEventListener("onReady",function(a){b.onReady(a)});a.addEventListener("onStateChange",function(a){b.onStateChange(a)});a.addEventListener("onError",
function(a){b.onError(a)})},onReady:function(){this.isReady()?this.startVideo():(this.error="unabled to find youtube player",this.dispatch("error"))},isReady:function(){return this.youtube&&this.youtube.playVideo},onStateChange:function(a){switch(a.data){case 0:this.__ended=!0;this.__duration=NaN;this.dispatch("ended");break;case 1:this.__paused=!1;this.dispatch("playing");this.dispatch("play");break;case 2:this.__paused=!0;this.dispatch("pause");break;case 3:this.startDurationCheck();this.startTimeCheck();
break;case 5:this.dispatch("canplay"),this.dispatch("loadeddata")}},onError:function(){this.dispatch("error")},startTimeCheck:function(){var a=this;if(!this._timeCheckInterval)this._timeCheckInterval=setInterval(function(){a.onTimeUpdate()},this.updateMsec),this.updateTime()},stopTimeCheck:function(){clearInterval(this._timeCheckInterval);this._timeCheckInterval=null},onTimeUpdate:function(){this.updateTime();this.dispatch("timeupdate")},updateTime:function(){this.__currentTime=this.youtube.getCurrentTime()},
startDurationCheck:function(){var a=this;if(!this.__duration&&!this._durationCheckInterval)this._durationCheckInterval=setInterval(function(){a.onDurationCheck()},this.updateMsec)},onDurationCheck:function(){var a=this.youtube.getDuration();if(0<a)this.__duration=a,this.dispatch("loadedmetadata"),this.dispatch("durationchange"),clearInterval(this._durationCheckInterval),this._durationCheckInterval=null},startVideo:function(){if(this.isReady()){this.__ended=!1;this.__muted&&this.youtube.mute();this.youtube.setVolume(this.__volume);
var a=this.src();if(a){if(4>this.__readyState)this.dispatch("loadstart"),this.__readyState=4;if(a.match("^http"))var b=a.match(/www.youtube.com\/(watch\?v=|v\/)([\w-]+)/)[2];this.youtube.cueVideoById(b||a);this.autoplay?this.play():this.preload&&this.load()}}},doSeek:function(a){this.__seeking=!0;this.dispatch("seeking");this.youtube.seekTo(a);this.__currentTime=a;var b=this;setTimeout(function(){b.updateTime();b.__seeking=!1;b.dispatch("seeked");b.dispatch("timeupdate")},1500)},load:function(){this.preload=
!0;this.isReady()&&-1==this.youtube.getPlayerState()&&(this.src(),this.youtube.playVideo(),this.youtube.pauseVideo())},play:function(){this.autoplay=!0;this.isReady()&&this.youtube.playVideo()},pause:function(){if(!this.isReady())return!1;this.youtube.pauseVideo()},canPlayType:function(a){return Boolean(a.match(/\/youtube$/))},paused:function(){return this.__paused},duration:function(){return this.__duration},seeking:function(){return this.__seeking},ended:function(){return!this.isReady()?!1:0==this.youtube.getPlayerState()},
currentTime:function(a){if(!this.isReady())return 0;if(void 0!=a)this.__ended=!1,this.doSeek(a);return this.__currentTime},muted:function(a){if(null!=a){this.__muted=a;if(!this.isReady())return a;a?this.youtube.mute():this.youtube.unMute();this.dispatch("volumechange");return a}return this.__muted},volume:function(a){if(null!=a){this.__volume=a;if(!this.isReady())return a;this.youtube.setVolume(100*a);this.dispatch("volumechange")}return this.__volume},src:function(a){if(void 0!==a)this.__src=a,this.startVideo();
return this.__src},readyState:function(){return this.__readyState}}})();
(function(){var d=jQuery,g=window.ovp,f={strategy:{order:["HTML5","Flash","Silverlight"]},sliderdelay:5E3,sliderspeed:"slow",immediately:!1,controls:{src_img:"/images/play.png"},ovp_container_class:"ovp",controller_keepalive_seconds:5,players:{Flash:{src:"ovp-2.1.6.swf",minver:"10",controls:!1,plugins:[]},Silverlight:{src:"ovp-2.3.1.xap",minver:"4.0",controls:!1,plugins:[]},HTML5:{minver:"0",controls:!1}},status_timer:500,ovpConfig:{sources:[{src:"/videos/trailer.ogv",type:"video/ogg"},{src:"/videos/trailer.mp4",
type:"video/mp4"}],width:"100%",height:"100%",posterimg:"/images/poster.png",autobuffer:!0,autoplay:!1,id:"ovp",scalemode:"fit",controls:!1}},a=function(b,c){if(!(this instanceof a))return new a(b,c);this.config=d.extend(!0,{},f,c);this.__readyState=0;this.__paused=!this.config.immediately;this.__duration=NaN;this.__controls=this.__seeking=this.__ended=!1;this.__volume=1;this.__muted=!1;this.__src="";this.__status=0;this._ovp=this._render(d(b).get(0));this.video=d(b).get(0);this.dispatcher=MetaPlayer.dispatcher(this);
MetaPlayer.proxy.proxyPlayer(this,this.video);this._setControls();this._addEventListeners()};window.MetaPlayer?MetaPlayer.addPlayer("ovp",function(b){var c=d("<div></div>").appendTo(this.layout.stage);this.ovp=a(c,b);this.video=this.ovp.video}):window.MetaPlayer={};MetaPlayer.ovp=function(b,c){return a(b,c).video};a.prototype={_render:function(a){var c=this.config.immediately;if(!c)this.config.immediately=!0;g.init(this.config);this.config.immediately=c;return g.render(a,this.config.ovpConfig)[0]},
_addEventListeners:function(){this._loadtimer=Ramp.timer(this.config.status_timer);this._loadtimer.listen("time",this._onBeforeLoad,this);this._loadtimer.start();this._statustimer=Ramp.timer(this.config.status_timer);this._statustimer.listen("time",this._onStatus,this)},_onBeforeLoad:function(){"object"===typeof this._ovp.player&&(this.dispatch("loadstart"),this._loadtimer.reset(),this._onReady(),this._startDurationCheck())},_onReady:function(){this._statustimer.start();this.__readyState=4;this.dispatch("loadeddata");
this.dispatch("canplay");this.load();this.__status=1;this.video.pause();(this.config.immediately||this.config.ovpConfig.autoplay)&&this.video.play()},_startDurationCheck:function(){var a=this;if(!this._durationCheckInterval)this._durationCheckInterval=setInterval(function(){a._onDurationCheck()},1E3)},_onDurationCheck:function(){var a=this._ovp.getDuration();if(0<a)this.__duration=a,this.dispatch("loadeddata"),this.dispatch("loadedmetadata"),this.dispatch("durationchange"),this.dispatch("timeupdate"),
clearInterval(this._durationCheckInterval),this._durationCheckInterval=null},_onStatus:function(){this._ovp.isPlaying()?(this.__paused=!1,2!==this.__status&&this.dispatch("play"),this.dispatch("timeupdate"),this.__status=2):this._ovp.isEnded()?(this.__paused=!0,5!==this.__status&&this.dispatch("ended"),this.__status=5):(this.__paused=!0,3!==this.__status&&this.dispatch("pause"),this.__status=3)},_setControls:function(){if("RENDERED"===this._ovp.controlsState)this.__controls=this._ovp.controls},_getCurrentTimeFromCache:function(){if(!this._ovp.player)return 0;
var a=(new Date).getTime(),c=this.__currentTimeCache,d=a-c;if(c&&d<this.config.status_timer)return this.__currentTime+d/1E3;this.__currentTimeCache=a;a=this._ovp.getCurrentTime();return this.__currentTime=0>a?0:a},doSeek:function(a){this.__seeking=!0;this.dispatch("seeking");this._ovp.seekTo(a);this.__currentTime=a;this.__status=4;var c=this;setTimeout(function(){c.updateTime();c.__seeking=!1;c.dispatch("seeked");c.dispatch("timeupdate")},1500)},updateTime:function(){this.__currentTime=this._ovp.getCurrentTime()},
load:function(){if(this._ovp.player){var a=this.src();if(a)this.config.ovpConfig.sources=[{src:a}]}},play:function(){this.__paused=!1;this._ovp.playpause()},pause:function(){this.__paused=!0;this._ovp.playpause()},canPlayType:function(){return this._ovp.canPlay()},paused:function(){return this.__paused},duration:function(){return this.__duration},seeking:function(){return this.__seeking},ended:function(){return this.__ended},currentTime:function(a){if("undefined"!==typeof a){0>a&&(a=0);if(a>this.duration)a=
this.duration;this.doSeek(a)}return this._getCurrentTimeFromCache()},readyState:function(a){if(void 0!==a)this.__readyState=a;return this.__readyState},muted:function(a){if(null!=a){this.__muted=a;if(!this._ovp)return a;this._ovp.mutetoggle();this.dispatch("volumechange");return a}return this.__muted},volume:function(a){if(null!=a){this.__volume=a;if(!this._ovp)return a;this._ovp.mutetoggle();this.dispatch("volumechange")}return this.__volume},src:function(a){if(void 0!==a)this.__src=a;return this.__src},
controls:function(a){if("undefined"!==typeof a||!1!=a)this.__controls=a;return this.__controls}}})();
(function(){var d=jQuery,g=window.jwplayer,f={autostart:!0,autobuffer:!0,controlbar:"none",flashplayer:"",file:"",image:"",id:"jwplayer",volume:100,width:"100%",height:"100%",icons:!1,events:{onTime:function(){},onMeta:function(){}},plugins:{viral:{onpause:!1,oncomplete:!1,allowmenu:!1}}},a=function(b,c){if(!(this instanceof a))return new a(b,c);this.config=d.extend(!0,{},f,c);this.__autoplay=this.config.autostart;this.__autobuffer=this.config.autobuffer;this.__volume=this.config.volume/100;this.__seeking=
null;this.__readyState=0;this.__ended=!1;this.__paused=!this.config.autostart;this.__duration=NaN;this.__metadata=null;this.__started=!1;this.__currentTime=0;this.__src="";this._jwplayer=this._render(d(b).get(0));this.video=this._jwplayer.container;this.dispatcher=MetaPlayer.dispatcher(this);MetaPlayer.proxy.proxyPlayer(this,this.video);var g=this;this._jwplayer.onReady(function(){g._onLoad()})};window.MetaPlayer?MetaPlayer.addPlayer("jwplayer",function(b){var c=d("<div></div>").appendTo(this.layout.stage);
d(c).attr("id",b.id);this.jwplayer=a(c,b);this.video=this.jwplayer.video}):window.MetaPlayer={};MetaPlayer.jwplayer=function(b,c){return a(b,c).video};a.prototype={_render:function(a){g(a).setup(this.config);return g(a)},_onLoad:function(){var a=this;this._jwplayer.onPlay(function(){a.__ended=!1;a.__paused=!1;a.__started=!0;a.dispatch("play")});this._jwplayer.onPause(function(){a.__paused=!0;a.dispatch("pause")});this._jwplayer.onTime(function(c){a.__currentTime=c.position;a.dispatch("timeupdate")});
this._jwplayer.onIdle(function(){});this._jwplayer.onBuffer(function(){a.dispatch("buffering")});this._jwplayer.onSeek(function(c){a.__seeking=c.offset;a.__currentTime=c.offset;a.dispatch("seeked")});this._jwplayer.onComplete(function(){a.__ended=!0;a.__started=!1;a.__paused=!0;a.dispatch("ended")});this._jwplayer.onVolume(function(){a.dispatch("volumechange")});this._jwplayer.onMute(function(){a.dispatch("volumechange")});this._jwplayer.onMeta(function(c){a.__metadata=c.metadata;if(c.metadata.duration&&
0<c.metadata.duration)a.__duration=c.metadata.duration,a.dispatch("loadeddata"),a.dispatch("loadedmetadata"),a.dispatch("durationchange")});this._jwplayer.onPlaylist(function(){a.__started=!1;a.dispatch("playlistChange")});this._jwplayer.onError(function(){a.__started=!1});this.__src=this._getSrc();this.dispatch("loadstart");this.dispatch("canplay");(this._getAutoBuffer()||this._getAutoPlay())&&this.load()},_doSeek:function(a){this.__seeking=!0;this.dispatch("seeking");this._jwplayer.seek(a);this.__currentTime=
a;var c=this;setTimeout(function(){c._updateTime();c.__seeking=!1;c.dispatch("seeked");c.dispatch("timeupdate")},1500)},_updateTime:function(){this.__currentTime=this._jwplayer.getPosition()},_getAutoPlay:function(){return this.__autoplay},_getAutoBuffer:function(){return this.__autobuffer},_getSrc:function(){return!this._jwplayer?"":this._jwplayer.getPlaylist()[0].file},load:function(){this.src()&&this._jwplayer.load([{file:this.src()}]);this._jwplayer&&(this._getAutoPlay()?this._jwplayer.play():
(this._jwplayer.play(),this._jwplayer.pause()))},play:function(){this._jwplayer.play()},pause:function(){this._jwplayer.pause()},canPlayType:function(){return!0},paused:function(){return this.__paused},duration:function(){return this.__duration},seeking:function(){return null!==this.__seeking},ended:function(){return this.__ended},currentTime:function(a){if(void 0!==a){0>a&&(a=0);if(a>this.duration)a=this.duration;this._doSeek(a)}return this.__currentTime},readyState:function(){return this.__readyState},
muted:function(a){void 0!==a&&this._jwplayer.setMute();return this._jwplayer.getMute()},volume:function(a){if(null!=a){this.__volume=a;if(!this._jwplayer)return a;this._jwplayer.setVolume(100*a);this.dispatch("volumechange")}return 1<this.__volume?this.__volume/100:this.__volume},src:function(a){if(void 0!==a)this.__src=a;return this.__src},controls:function(a){if("undefined"!==typeof a)this.__controls=a;return this.__controls}}})();
