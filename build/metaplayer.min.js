/*
Copyright (c) 2011 RAMP Holdings, Inc.

Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
*/
(function(){window.Ramp={wrap:function(c,f){return function(){c.apply(f||this,arguments)}}};Ramp.Players={};Ramp.Services={};Ramp.Views={};Ramp.UI={};Ramp.Utils={};Ramp.Models={}})();(function(){})();
(function(){var c=function(f){if(!(this instanceof c))return new c(f);this._listeners={};this._observed={};f&&this.attach(f)};Ramp.Utils.EventDispatcher=c;c.prototype={_interface:"listen forget dispatch addEventListener removeEventListener dispatchEvent",attach:function(c){var d=this._interface.split(/\s+/g),a,b;for(a=0;a<d.length;a++)b=d[a],c[b]=this._wrap(b)},_wrap:function(c){var d=this;return function(){return d[c].apply(d,arguments)}},listen:function(c,d,a,b){this._listeners[c]||(this._listeners[c]=
[]);this._listeners[c].push({fn:d,scope:a,data:b})},forget:function(c,d){var a=this._listeners[c];if(a){var b;for(b=a.length-1;0<=b;b--)(a[b].fn=d)&&a.splice(b,1)}},dispatch:function(c,d,a){var b=this._listeners[c];a||(a={});a.type=c;a.source=this;if(void 0!==d)a.data=d;void 0!==this._observed[c]&&(this._observed[c]=d||!0);if(b)for(c=0;c<b.length;c++)b[c].fn.call(b[c].scope||this,a,b[c].data)},observer:function(c){this._observed[c]=null;var d=this;return function(a,b){var e=function(){a.call(b,d._observed[c])};
d.listen(c,e);null!==d._observed[c]&&setTimeout(e,0)}},addEventListener:function(c,d){this.listen(c,d)},removeEventListener:function(c,d){this.forget(c,d)},dispatchEvent:function(c){if(!(c instanceof Object))throw"invalid event";this.dispatch(c.type,null,c)}}})();(function(){Ramp.Utils.Format={seconds:function(c){var f=function(b,a){for(var c=""+b;c.length<a;)c="0"+c;return c},d=Math.floor(c/3600),a=Math.floor(c%60),c=[f(Math.floor(c%3600/60),2),f(a,2)];d&&c.unshift(d);return c.join(":")}}})();
(function(){var c=jQuery,f={proxyProperty:function(d,a,b){c.each(d.split(/\s+/g),function(e,c){f.mapProperty(c,b,a)})},proxyFunction:function(d,a,b){c.each(d.split(/\s+/g),function(e,c){b[c]=function(){return a[c].apply(a,arguments)}})},proxyEvent:function(d,a,b){b.addEventListener||Ramp.Utils.EventDispatcher().attach(b);c.each(d.split(/\s+/g),function(e,d){c(a).bind(d,function(a){if(b.dispatch)b.dispatch(a.type);else{var e=document.createEvent("Event");e.initEvent(a.type,!1,!1);b.dispatchEvent(e)}})})},
mapProperty:function(d,a,b){b||(b=a);c.each(d.split(/\s+/g),function(e,c){var d=void 0==b[c]?"_"+c:c,h;h=b[d]instanceof Function?function(){return b[d].apply(b,arguments)}:function(a){void 0!==a&&(b[d]=a);return b[d]};f.define(a,c,{get:h,set:h})})},define:function(c,a,b){try{return Object.defineProperty(c,a,b)}catch(e){}c.__defineGetter&&b.get&&c.__defineGetter__(a,b.get);b.set&&c.__defineSetter__&&c.__defineSetter__(a,b.set)},getProxyObject:function(c){try{return Object.defineProperty(c,"__proptest",
{}),c}catch(a){}c={parentNode:c.parentNode};try{return Object.defineProperty(c,"__proptest",{}),c}catch(b){}throw"Object.defineProperty not defined";}};if(!window.Ramp)window.Ramp={};if(!Ramp.Utils)Ramp.Utils={};Ramp.Utils.Proxy=f})();(function(){var c=jQuery;Ramp.Utils.Script={url:function(f){var d,a=RegExp(f);c("script").each(function(b,e){var g=c(e).attr("src");if(g&&g.match(a))return d=g,!1});return d},base:function(c){c=this.url(c)||"";return c.substr(0,c.lastIndexOf("/")+1)}}})();
(function(){Ramp.Timer=function(c,f){if(!(this instanceof Ramp.Timer))return new Ramp.Timer(c,f);var d=this;Ramp.Utils.EventDispatcher(this);this.delay=c;this.count=f||-1;this._counted=0;this._onTimeout=function(){d._counted++;d.dispatch("time",{count:d._counted,remain:d.count-d._counted});0<d.count&&d.count<d._counted+1&&(d.reset(),d.dispatch("complete"))}};Ramp.Timer.prototype={reset:function(){this._counted=0;this.stop()},stop:function(){clearInterval(this._interval);this.running=this._interval=
null},toggle:function(){this.running?this.stop():this.start()},start:function(){if(!this._interval)this.running=(new Date).getTime(),this._interval=setInterval(this._onTimeout,this.delay)}}})();
(function(){var c=jQuery;if(!window.Ramp)window.Ramp={};Ramp.UI={ensureOffsetParent:function(f){var f=c(f).first(),d=f[0];if(!(d.offsetParent===d.parentNode&&d.offsetParent.offsetParent)){var a=c("<div></div>");a.css("position","relative");a.css("top",0);a.css("left",0);a.css("width","100%");a.css("height","100%");d.width&&a.width(d.width);d.height&&a.height(d.height);f.css("width","100%");f.css("height","100%");f.parent().append(a);a.append(f)}}}})();
(function(){var c=jQuery,f={applySources:!0,selectSource:!0,autoAdvance:!0,autoPlay:!0,autoBuffer:!0,related:!0,loop:!1},d=function(a,b,e){if(!(this instanceof d))return new d(a,b,e);void 0==e&&b instanceof Object&&(e=b,b=null);this.config=c.extend({},f,e);if(a.service)this.config.service=a.service;this.video=c(a).get(0);this.dispatcher=a.dispatcher||this.config.dispatcher||Ramp.Utils.EventDispatcher();this.dispatcher.attach(this);this._haveRelated=!1;this._tracks=[];this._index=0;this.loop=this.config.loop;
this.autoplay=this.config.autoPlay;this.preload=this.config.autoBuffer;this.advance=this.config.autoAdvance;this.service=this.config.service?this.config.service:Ramp.data({dispatcher:this._dispatcher});this.video.service=this.service;this.onPlaylistChange=this.dispatcher.observer("playlistChange");this.onTrackChange=this.dispatcher.observer("trackChange");this._addServiceListeners();this._addMediaListeners();b&&this.queue(b);this.video.playlist=this};Ramp.playlist=d;d.prototype={index:function(a){if(void 0!=
a)this._index=this._resolveIndex(a),this.dispatcher.dispatch("trackChange"),this.service.load(this.track());return this._index},queue:function(a){a instanceof Array||(a=[a]);var b=0==this._tracks.length,e=this;c(a).each(function(b,a){e._addTrack(a,!0)});this.dispatcher.dispatch("playlistChange");b&&this.service.load(this.track())},empty:function(){this._tracks=[];this._index=0;this.dispatcher.dispatch("playlistChange");this.dispatcher.dispatch("trackChange")},next:function(){this.index(this._index+
1)},previous:function(){this.index(this._index-1)},track:function(a){void 0===a&&(a=this.index());return this._tracks[this._resolveIndex(a)]},nextTrack:function(){return this.track(this._index+1)},tracks:function(){return this._tracks},_addTrack:function(a){"string"==typeof a&&(a={url:a});this._tracks.push(a)},_resolveIndex:function(a){var b=this.tracks();0>a&&(a=b.length+a);this.loop&&(a%=b.length);return a>=b.length||0>a?void 0:a},_addServiceListeners:function(){this.service.onMetaData(this._onMetaData,
this);this.service.onTranscodes(this._onTranscodes,this);this.service.onRelated(this._onRelated,this)},_addMediaListeners:function(){var a=this;c(this.video).bind("ended",function(){a._onEnded()})},_onMetaData:function(a){c.extend(this.track(),a);this._metadata=a},_onRelated:function(a){if(!this._haveRelated&&this.config.related)this.queue(a),this._haveRelated=!0},_onTranscodes:function(a){var b=this.video,e=[],d=[];c.each(a,function(a,c){var f=b.canPlayType(c.type);f&&("probably"==f?e.push(c.url):
d.push(c.url))});if(a=e.shift()||d.shift())b.src=a;b.autoplay=!0;b.autoplay?b.play():b.preload&&b.load()},_onEnded:function(){this.advance&&(this.index()==this.tracks().length-1&&this.dispatcher.dispatch("playlistComplete"),this.next())},decorate:function(){Ramp.Utils.Proxy.mapProperty("index advance service",this.video,this);Ramp.Utils.Proxy.proxyFunction("next previous track tracks queue clear nextTrack nextTrackIndex onPlaylistChange onTrackChange",this,this.video);Ramp.Utils.Proxy.proxyEvent("trackChange playlistChange ",
this,this.video)}}})();
(function(){var c=jQuery,f={jsonService:"/{e}.json"},d=function(a,b){if(!(this instanceof d))return new d(a,b);void 0==b&&a instanceof Object&&(b=a,a=null);this.config=c.extend({},f,b);var e=this.config.dispatcher||Ramp.Utils.EventDispatcher();e.attach(this);this.onMetaData=e.observer("metaData");this.onTranscodes=e.observer("transcodes");this.onCaptions=e.observer("captions");this.onTags=e.observer("tags");this.onMetaQ=e.observer("metaQ");this.onRelated=e.observer("related");this.onMediaChange=e.observer("mediaChange");
a&&this.load(a)};Ramp.data=function(a,b){return d(a,b)};d.prototype={_interface:"onMetaData onTranscodes onCaptions onTags onMetaQ onRelated onMediaChange",attach:function(a){var b=this,e=this._interface.split(/\s+/g);c.each(e,function(e,c){var d=b[c];"_"!=c[0]&&d instanceof Function&&(a[c]=function(){return b[c].apply(b,arguments)})})},parse:function(a){return jQuery.parseJSON(a)},load:function(a){"string"==typeof a?a=d.parseUrl(a):a.url&&!a.rampId&&d.parseUrl(a.url,a);if(!a.rampId)throw"invalide media id";
this.mediaId&&this.dispatch("mediaChange");this.mediaId=a.rampId;if(a.rampHost)this.lastHost=a.rampHost;var b=this.lastHost+this.config.jsonService.replace(/{e}/,this.mediaId);c.ajax(b,{dataType:"json",timeout:5E3,context:this,error:function(a,c){console.error("Load  error: "+c+", url: "+b)},success:function(b){this.dispatch("metadata",b.metadata);this.dispatch("related",b.related);this.dispatch("transcodes",b.transcodes);this.dispatch("captions",b.captions);this.dispatch("tags",b.tags);this.dispatch("metaq",
b.metaq)}})},search:function(){throw"not implemented";}};d.parseUrl=function(a,b){var c=a.split(":");void 0==b&&(b={});"ramp"!==c[0]?b.url=a:(b.rampHost=c[1],b.rampId=c[2]);return b}})();
(function(){var c=jQuery,f={playlistService:"/device/services/mp2-playlist?e={e}"},d=function(a,b){if(!(this instanceof d))return new d(a,b);void 0==b&&a instanceof Object&&(b=a,a=null);this.config=c.extend({},f,b);var e=this.config.dispatcher||Ramp.Utils.EventDispatcher();e.attach(this);this.onMetaData=e.observer("metaData");this.onTranscodes=e.observer("transcodes");this.onCaptions=e.observer("captions");this.onTags=e.observer("tags");this.onMetaQ=e.observer("metaQ");this.onRelated=e.observer("related");
this.onMediaChange=e.observer("mediaChange");this.onSearch=e.observer("search");a&&this.load(a)};d.msQuotes=!0;d.rebase=!0;Ramp.Services.SmilService=d;Ramp.data=function(a,b){return d(a,b)};d.parseUrl=function(a,b){var c=a.split(":");void 0==b&&(b={});"ramp"!==c[0]?b.url=a:(b.rampHost=c[1],b.rampId=c[2]);return b};d.prototype={_interface:"onMetaData onTranscodes onCaptions onTags onMetaQ onRelated onMediaChange",attach:function(a){var b=this,e=this._interface.split(/\s+/g);c.each(e,function(c,e){var d=
b[e];"_"!=e[0]&&d instanceof Function&&(a[e]=function(){return b[e].apply(b,arguments)})})},load:function(a){"string"==typeof a?a=d.parseUrl(a):a.url&&!a.rampId&&d.parseUrl(a.url,a);if(!a.rampId)throw"invalide media id";this.mediaId&&this.dispatch("mediaChange");this.mediaId=a.rampId;if(a.rampHost)this.lastHost=a.rampHost;var b=this.lastHost||rampHost,e=b+this.config.playlistService.replace(/{e}/,this.mediaId);c.ajax(e,{dataType:"xml",timeout:15E3,context:this,data:{},error:function(b,a){console.error("Load playlist error: "+
a+", url: "+e)},success:function(a){a=this.parse(a);a.metadata.host=b;this._data=a;this.dispatch("metaData",a.metadata);this.dispatch("transcodes",a.transcodes);this.dispatch("captions",a.captions);this.dispatch("tags",a.tags);this.dispatch("metaQ",a.metaq);this.dispatch("related",a.related)}})},parse:function(a){var b=this,a=c(a).find("par").toArray(),e=this.parseMedia(a.shift());c.each(a,function(a,c){e.related.push(b.parseMedia(c).metadata)});return e},parseMedia:function(a){var b={metadata:{},
transcodes:[],tags:[],captions:[],metaq:{},related:[]},e=c(a).find("video");b.metadata.title=e.attr("title");e.find("metadata meta").each(function(a,e){var d=c(e);b.metadata[d.attr("name")]=d.attr("content")||d.text()});b.transcodes.push({name:"default",type:"video/"+e.attr("type"),url:e.attr("src")});c(a).find("metadata[xml\\:id^=transcodes]").find("meta").each(function(a,e){var f=c(e);b.transcodes.push({name:f.attr("name"),type:f.attr("type")||d.resolveType(f.attr("content")),url:f.attr("content")})});
c(a).find("seq[xml\\:id^=jumptags]").find("ref").each(function(a,e){var d={};c(e).find("param").each(function(b,a){var e=c(a);d[e.attr("name")]=e.text()});if(d.timestamps)d.timestamps=d.timestamps.split(",");b.tags.push(d)});c(a).find("seq[xml\\:id^=metaqs]").find("ref").each(function(a,e){var f={};c(e).find("param").each(function(b,a){var e=c(a),g=e.attr("name"),e=d.deSmart(e.text());"code"==g?(g=c.parseJSON(e),c.extend(!0,f,g)):f[g]=e});b.metaq[f.plugin]||(b.metaq[f.plugin]=[]);b.metaq[f.plugin].push(f)});
a=c(a).find("smilText");b.captions=d.parseCaptions(a);return b},search:function(a,b,e){var g=this._data.metadata.searchapi;d.rebase&&(g=g.replace(/^(.*\/\/[\w.]+)/,""));var f={q:a};a?c.ajax(g,{dataType:"xml",timeout:15E3,context:this,data:f,error:function(b,a){console.error("Load search error: "+a+", url: "+g)},success:function(a){a=d.parseSearch(a);this.dispatch("search",a);b&&b.call(e,a)}}):(a={query:[],results:[]},this.dispatch("search",a),b.call(e,a))}};d.parseSearch=function(a){var a=c(a),b=
{query:[],results:[]};a.find("SearchTerms Term").each(function(){b.query.push(d.deSmart(c(this).text()))});a.find("Snippets Snippet").each(function(a,g){var f=c(g),h={start:f.attr("time"),words:[]},f=f.find("T");c.each(f,function(b,a){var e=c(a);h.words.push({match:Boolean(e.find("MQ").length),start:e.attr("s"),text:d.deSmart(e.text())})});b.results.push(h)});return b};d.parseCaptions=function(a){var b=c(a).contents(),e=[],g={text:"",start:0,offset:0},f,h=function(b,a){var h;var j=c(b);h=d.parseSeconds;
var k=j.attr("begin");null!=k?h=h(k):(j=j.attr("next"),h=null!=j?h(j)+(void 0).start:void 0);f=g;f.end=h;a&&(f.text+=a);e.push(f);g={text:"",start:h,offset:g.offset+1}};b.each(function(a,c){var e=b[a].data;if(void 0===c.tagName)d.msQuotes&&(e=d.deSmart(e)),g.text+=e;else switch(c.tagName){case "smil:clear":case "clear":h(c);break;case "smil:tev":case "tev":h(c);break;case "smil:br":case "br":h(c,"<br />");break;default:throw"unsupported tag";}});g.text&&e.push(g);return e};d.parseSeconds=function(a){var b=
a.substr(-1),c=parseFloat(a);if("s"==b)return c;if("m"==b)return 60*c;if("h"==b)return 3600*c;b=0;a=a.split(":");for(c=0;c<Math.min(a.length,4);c++)b+=Math.pow(60,c)*parseFloat(a[c]);return b};d.deSmart=function(a){return a.replace(/\xC2\x92/,"\u2019")};d.resolveType=function(a){a=a.substr(a.lastIndexOf(".")+1);"ogv"==a&&(a="ogg");return"video/"+a}})();
(function(){var c=jQuery,f={applySources:!0,selectSource:!0,preload:!0,muted:!1,autoplay:!1,autoAdvance:!0,related:!0,loop:!1,controls:!0},d=function(a,b,e){if(!(this instanceof d))return new d(a,b,e);this.config=c.extend({},f,e);this._createMarkup(a);this.service=Ramp.data({});this.service.attach(this);this.video.service=this.service;Ramp.playlist?Ramp.playlist(this.video,b):this.video.src=b};Ramp.html5=function(a,b,c){a=d(a,b,c);a.video._player=a;return a.video};Ramp.metaplayer=Ramp.html5;Ramp.Players.Html5Player=
d;d.prototype={_createMarkup:function(a){a=c(a);if(a.is("video"))this.video=a.get(0),Ramp.UI.ensureOffsetParent(this.video,!0);else{var b=document.createElement("video");b.autoplay=this.config.autoplay;b.preload=this.config.preload;b.controls=this.config.controls;b.muted=this.config.muted;b.style.position="absolute";b.style.top=0;b.style.left=0;b.style.width="100%";b.style.height="100%";this.video=b;a.append(b);Ramp.UI.ensureOffsetParent(this.video)}this.video.style.position="absolute"}}})();
(function(){var c=jQuery,f=window.flowplayer,d={autoplay:!1,preload:!0,controls:!0,swfUrl:"flowplayer-3.2.7.swf",wmode:"transparent",statusThrottleMSec:500,fpConfig:{clip:{scaling:"fit"}}},a=function(b,e,g){if(!(this instanceof a))return new a(b,e,g);this.config=c.extend(!0,{},d,g);this.dispatcher=this.config.dispatcher||Ramp.Utils.EventDispatcher();this.dispatcher.attach(this);this._iOS=/iPad|iPhone|iPod/i.test(navigator.userAgent);this.__seeking=null;this.__readyState=0;this.__ended=!1;this.__paused=
!0;this._pageSetup(b);this.__preload=this.config.preload;this.__autoplay=this.config.autoplay;this.__src=null;this._statepoll=Ramp.Timer(250);this._statepoll.listen("time",this._onPlayStatePoll,this);this._timeupdater=Ramp.Timer(250);this._timeupdater.listen("time",this._onTimeUpdate,this);var f=this;this._flowplayer.onLoad(function(){f._onLoad()});this.video=this.getInterface();Ramp.playlist?Ramp.playlist(this.video,e):this.src(e)};Ramp.flowplayer=function(b,c,d){b=a(b,c,d);b.video._player=b;return b.video};
a.prototype={_pageSetup:function(b){if(b.getCommonClip)this._flowplayer=b,b=this._flowplayer.getCommonClip(),this.preload(Boolean(b.autoBuffering)),this.autoplay(Boolean(b.autoPlay));else{var a=c.extend(!0,{clip:{autoPlay:!1,autoBuffering:!0}},this.config.fpConfig),d=c('<div class="mp-video""></div>');c(b).append(d);this._flowplayer=f(d.get(0),{src:this.config.swfUrl,wmode:this.config.wmode},a)}},_onLoad:function(){if(!this._onLoadFired){this._onLoadFired=!0;var b=this;this._flowplayer.onVolume(function(){b.dispatch("volumechange")});
this._flowplayer.onMute(function(){b.dispatch("volumechange")});this._flowplayer.onUnmute(function(){b.dispatch("volumechange")});this._flowplayer.onPlaylistReplace(function(){b.dispatch("playlistChange")});this._flowplayer.onClipAdd(function(){b.dispatch("playlistChange")});this.controls(this.config.controls);b.dispatch("loadstart");this.__src&&this.src(this.__src);(this.preload()||this.autoplay())&&this.load()}},_addClipListeners:function(b){var a=this;b.onBeforeBegin(function(){return!0});b.onBegin(function(){a._flowplayer.setVolume(100);
a._flowplayer.unmute()});b.onStart(function(b){a._setReady();a._setPlaying(!0);if(a._iOS&&!a.__controls)c(a._flowplayer.getParent()).find("video").get(0).controls=!1;a.dispatch("loadeddata");a.__duration=b.duration;a.dispatch("durationchange");a.dispatch("loadedmetadata")});b.onStop(function(){});b.onFinish(function(){a.__ended=!0;a.__seeking=null;a._setPlaying(!1);a._flowplayer.stop();a.dispatch("ended")});b.onPause(function(){a._setPlaying(!1);a._setReady()});b.onResume(function(){a._setPlaying(!0);
a.dispatch("play")});b.onBeforeSeek(function(){a.dispatch("seeking");a.dispatch("timeupdate");if(a.paused())a.dispatch("seeked"),a.__seeking=null});b.onSeek(function(){a.__seeking=null;a.paused()||a.dispatch("seeked")})},_setReady:function(){4!=this.__readyState?(this.__readyState=4,this.dispatch("canplay")):(this.dispatch("seeking"),this.dispatch("seeked"))},_setPlaying:function(b){this.__paused=!b;this._statepoll.start()},load:function(){this.preload(!0);if(this.src()&&this._flowplayer.isLoaded())this._flowplayer.getClip(0).update({autoPlay:this.autoplay(),
autoBuffer:!0}),window.flashembed.__replaced&&!this.__loaded?(this._flowplayer.play(0),this.autoplay()&&this._flowplayer.play(0),this.__loaded=!0):this.autoplay()?this._flowplayer.play():this._flowplayer.startBuffering()},play:function(){this.autoplay(!0);this.__paused=!1;this.load()},pause:function(){this._flowplayer.pause()},canPlayType:function(b){if(this._iOS&&b.match(/m3u8$/))return"probably";if(b.match(/mov|m4v|mp4|avi$/))return"maybe"},paused:function(){return this.__paused},duration:function(){return this.__duration},
seeking:function(){return null!==this.__seeking},ended:function(){return this.__ended},currentTime:function(b){if(void 0!==b){0>b&&(b=0);if(b>this.duration)b=this.duration;this.__seeking=b;this._flowplayer.seek(b)}if(null!==this.__seeking)return this.__seeking;if(!this._flowplayer.isLoaded())return 0;var b=(new Date).getTime(),a=this.__currentTimeCache,c=b-a;if(a&&c<this.config.statusThrottleMSec)return this.__currentTime+c/1E3;this.__currentTimeCache=b;return this.__currentTime=this._flowplayer.getStatus().time},
muted:function(a){void 0!==a&&(a?this._flowplayer.mute():this._flowplayer.unmute());return this._flowplayer.getStatus().muted},volume:function(a){void 0!==a&&this._flowplayer.setVolume(100*a);return this._flowplayer.getVolume()/100},controls:function(a){if(!this._flowplayer.isLoaded()){if(void 0!==a)this.config.controls=a;return this.config.controls}var d=this._flowplayer.getControls(),f=this._flowplayer.getPlugin("play"),i=c(this._flowplayer.getParent()).find("video").get(0);if(void 0!==a)(this.__controls=
a)?(d&&d.show(),f&&f.show(),i&&(i.controls=!0)):(d&&d.hide(),f&&f.hide(),i&&(i.controls=!1));return this.__controls},preload:function(a){if(void 0!==a)this.__preload=a;return this.__preload},autoplay:function(a){if(void 0!==a)this.__autoplay=a;return this.__autoplay},loop:function(a){if(void 0!==a)this.__loop=a;return this.__loop},src:function(a){if(void 0!==a)this.__src=a,this.__loaded=!1,a=this._flowplayer,a.isLoaded()&&(a.setClip({autoPlay:!1,autoBuffering:!1,url:this.__src}),this._addClipListeners(a.getClip(0)));
return this.__src},readyState:function(a){if(void 0!==a)this.__readyState=a;return this.__readyState},_children:function(){var a=document.createElement("source");a.setAttribute("type","video/ramp");a.setAttribute("src",this.src);return[a]},getInterface:function(){var a=Ramp.Utils.Proxy.getProxyObject(this._flowplayer.getParent());Ramp.Utils.Proxy.mapProperty("duration currentTime volume muted seeking seekable paused played controls autoplay preload src ended readyState children",a,this);Ramp.Utils.Proxy.proxyFunction("load play pause canPlayType",
this,a);Ramp.Utils.Proxy.proxyEvent("timeupdate seeking seeked playing play pause loadeddata loadedmetadata canplay loadstart durationchange volumechange ended ",this,a);return a},_onPlayStatePoll:function(){this._flowplayer.isPlaying()!==this.paused()&&(this._statepoll.reset(),this.paused()?(this.dispatch("pause"),this._timeupdater.reset()):(this.autoplay(!0),this.dispatch("playing"),this.dispatch("play"),this._timeupdater.start()))},_onTimeUpdate:function(){this.dispatch("timeupdate")}}})();
(function(){var c=jQuery,f=window.Popcorn,d={subtitles:!0},a=function(b,e,g){if(!(this instanceof a))return new a(b,e,g);if(window.Popcorn&&f instanceof Function){b.getTrackEvent?this.popcorn=b:b.popcorn?this.popcorn=b.popcorn:(this.popcorn=f(b),b.popcorn=this.popcorn);if(void 0==g&&b.service)g=e,e=b.service;this.config=c.extend(!0,{},d,g);this.player=b;this.service=e;this._sequences={};this.metaq={};this.addDataListeners()}};Ramp.metaq=function(b,c){return a(b,c)};a.prototype={addDataListeners:function(){this.service&&
(this.service.onMetaData(this.onMetaData,this),this.service.onCaptions(this._onCaptions,this),this.service.onMetaQ(this._onMetaq,this))},_onCaptions:function(a){this.config.subtitles&&c.extend(this.metaq,{subtitle:a})},_onMetaq:function(a){c.extend(this.metaq,a);this._renderPopcorn()},onMetaData:function(){var a=this.popcorn.getTrackEvents(),d=this;c.each(a,function(a,b){d.popcorn.removeTrackEvent(b._id)});this.metaq={}},_renderPopcorn:function(){var a=this;c.each(this.config,function(d,f){c.each(a.metaq,
function(i,h){c.each(h,function(h,l){if(i==d&&f.clone){var m=f.clone.split(/\s+/);c.each(m,function(d,e){a.metaq[e]||(a.metaq[e]=[]);a.metaq[e].push(c.extend({},l))})}})})});c.each(this.metaq,function(d,f){c.each(f,function(c,h){f[c]=a._composite(d,h)})});c.each(this.metaq,function(d,f){c.each(f,function(c,f){a._schedule(d,f)})})},_composite:function(a,d){var f=this.config[a];if(!f)return d;f.overrides&&(d=c.extend({},d,f.overrides));if(f.duration)d.end=d.start+f.duration;if(f.sequence){var i=this._sequences[f.sequence];
if(i)i.end=d.start;this._sequences[f.sequence]=d}return d},_schedule:function(a,c){var d=this.popcorn[a];d&&d.call(this.popcorn,c)}}})();
